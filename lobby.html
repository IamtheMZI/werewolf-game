<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Lobby - Werewolf</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/lobby.css">
</head>
<body>
    <div class="container lobby-container">
        <!-- Home Button -->
        <a href="index.html" class="home-button" title="Back to Home">
            <span class="home-icon">🏠</span>
        </a>

        <header class="lobby-header">
            <h1>🐺 Game Lobby</h1>
            <div class="room-info">
                <div class="room-code-display">
                    <span class="label">Room Code:</span>
                    <span id="roomCode" class="code">------</span>
                    <button id="copyCodeBtn" class="btn-icon" title="Copy room code">📋</button>
                </div>
            </div>
        </header>

        <main class="lobby-main">
            <!-- Players List -->
            <section class="players-section">
                <div class="section-header">
                    <h2>Players (<span id="playerCount">0</span>/10)</h2>
                    <span id="hostBadge" class="badge host-badge hidden">👑 You're the Host</span>
                </div>

                <div id="playersList" class="players-grid">
                    <!-- Players will be dynamically added here -->
                </div>

                <div class="player-status-message">
                    <p>Waiting for players to join...</p>
                    <p class="min-players">Minimum 3 players required to start</p>
                </div>
            </section>

            <!-- Game Settings (Host Only) -->
            <section id="gameSettings" class="settings-section hidden">
                <h2>Game Settings</h2>

                <div class="setting-group">
                    <label for="discussionTime">Discussion Time (minutes):</label>
                    <div class="slider-container">
                        <input type="range" id="discussionTime" min="2" max="10" value="5" step="1">
                        <span id="discussionTimeValue">5</span> min
                    </div>
                </div>

                <div class="setting-group">
                    <label>Roles to Include:</label>
                    <div class="roles-checklist">
                        <label class="checkbox-label">
                            <input type="checkbox" name="role" value="werewolf" checked disabled>
                            <span>🐺 Werewolf (Required)</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="role" value="seer" checked>
                            <span>🔮 Seer</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="role" value="robber" checked>
                            <span>🔄 Robber</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="role" value="drunk" checked>
                            <span>😴 Drunk</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="role" value="insomniac" checked>
                            <span>🧝 Insomniac</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="role" value="minion">
                            <span>😈 Minion</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="role" value="tanner">
                            <span>🃏 Tanner</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="role" value="villager" checked>
                            <span>😇 Villager</span>
                        </label>
                    </div>
                </div>

                <div class="role-summary">
                    <p><strong>Selected Roles:</strong> <span id="roleCount">0</span></p>
                    <p class="role-note">Total cards will be player count + 3 (center cards)</p>
                </div>

                <!-- Audio Narrator Section -->
                <div class="setting-group audio-narrator-setting">
                    <label for="audioNodeSelect">🎙️ Audio Narrator:</label>
                    <p class="setting-description">Select a player whose device will play voice narration during the game.</p>

                    <select id="audioNodeSelect" class="form-select">
                        <option value="">No Audio (Silent Mode)</option>
                        <!-- Players will be dynamically added here -->
                    </select>

                    <button id="randomAudioNodeBtn" class="btn btn-secondary btn-small" style="margin-top: 8px;">
                        🎲 Choose Randomly
                    </button>

                    <p class="audio-help-text">
                        💡 The selected player's device will play audio narration. Everyone else will see text prompts.
                    </p>
                </div>
            </section>

            <!-- Control Buttons -->
            <section class="lobby-controls">
                <button id="addBotBtn" class="btn btn-secondary hidden">🤖 Add Bot Player</button>
                <button id="leaveGameBtn" class="btn btn-secondary">Leave Game</button>
                <button id="startGameBtn" class="btn btn-primary hidden" disabled>
                    Start Game
                </button>
            </section>

            <!-- Game Info -->
            <section class="game-info">
                <details>
                    <summary>How to Play</summary>
                    <div class="info-content">
                        <h3>Game Overview</h3>
                        <p>One Night Ultimate Werewolf is a fast-paced game where players have hidden roles.
                        The goal depends on your role:</p>
                        <ul>
                            <li><strong>Villagers:</strong> Find and vote out a werewolf</li>
                            <li><strong>Werewolves:</strong> Avoid being voted out</li>
                            <li><strong>Others:</strong> Role-specific win conditions</li>
                        </ul>

                        <h3>Game Flow</h3>
                        <ol>
                            <li><strong>Setup:</strong> Each player receives a secret role</li>
                            <li><strong>Night Phase:</strong> Follow prompts to perform role actions</li>
                            <li><strong>Day Phase:</strong> Discuss and vote for who to eliminate</li>
                            <li><strong>Results:</strong> Reveal roles and determine winners</li>
                        </ol>
                    </div>
                </details>
            </section>
        </main>

        <footer class="lobby-footer">
            <p>Share the room code with your friends!</p>
            <p class="version" style="margin-top: 10px; font-size: 0.85em; opacity: 0.7;">Version <span id="app-version">1.0.3</span></p>
        </footer>
    </div>

    <!-- Toast Messages -->
    <div id="messageToast" class="toast hidden"></div>

    <script src="js/version.js" type="module"></script>
    <script src="js/lobby.js" type="module"></script>
</body>
</html>